# 环境数据监控系统 - 前端页面使用说明

## 概述

本系统提供了两个主要的前端页面，用于环境数据的可视化展示和数据上传功能。

## 页面访问地址

假设你的Django服务运行在 `http://localhost:8000`：

1. **数据可视化页面**：`http://localhost:8000/visualization/`
2. **数据上传页面**：`http://localhost:8000/upload/`

## 功能详细说明

### 1. 数据可视化页面 (`data_visualization.html`)

**主要功能：**
- 读取指定时间段的环境数据
- 使用折线图可视化温度、湿度、CO2浓度变化趋势
- 提供数据概览和详细数据表格

**使用方法：**
1. 选择查询的开始时间和结束时间
2. 点击"查询数据"按钮获取数据
3. 快捷按钮：
   - "最近24小时"：快速设置为最近24小时的数据
   - "最近一周"：快速设置为最近一周的数据

**页面特性：**
- 响应式设计，支持移动端访问
- 实时数据概览卡片显示平均值
- 交互式折线图，支持数据点悬停查看详情
- 数据表格展示详细信息
- 使用Bootstrap和Chart.js构建现代化UI

### 2. 数据上传页面 (`data_upload.html`)

**主要功能：**
- 单条数据录入上传
- CSV文件批量数据上传
- 上传历史记录查看

**使用方法：**

#### 单条数据上传：
1. 填写温度、湿度、CO2浓度等字段（至少填写一个）
2. 选择测量时间（默认为当前时间）
3. 点击"上传数据"按钮

#### 批量数据上传：
1. 准备CSV文件，格式如下：
   ```csv
   温度,湿度,CO2浓度,时间
   25.5,65.2,400,2024-01-15 10:00:00
   26.1,64.8,420,2024-01-15 10:15:00
   ```
2. 点击上传区域或拖拽CSV文件到指定区域
3. 预览数据确认无误后，点击"上传CSV文件"按钮

**页面特性：**
- 支持拖拽上传CSV文件
- 实时数据预览
- 文件格式验证
- 批量上传进度反馈
- 上传历史记录展示

## API 接口

页面使用以下API接口：

1. **数据查询接口**：`GET /list/`
   - 参数：`start`（开始时间），`end`（结束时间）
   - 格式：`YYYY-MM-DD HH:MM:SS`

2. **数据添加接口**：`POST /add/`
   - 请求体：JSON格式
   ```json
   {
     "temperature": "25.5",
     "damp": "65.2", 
     "co2": "400",
     "time": "2024-01-15 10:00:00"
   }
   ```

## 数据模型

系统使用的数据模型包含以下字段：
- `temperature`：温度（°C）
- `damp`：湿度（%）
- `co2`：CO2浓度（ppm）
- `time`：测量时间

## 技术栈

- **前端框架**：Bootstrap 5
- **图表库**：Chart.js
- **后端框架**：Django + Django REST Framework
- **数据库**：SQLite（可根据需要配置其他数据库）

## 使用注意事项

1. **时间格式**：确保时间格式为 `YYYY-MM-DD HH:MM:SS`
2. **数据类型**：温度和湿度支持小数，CO2浓度为整数
3. **CSV格式**：批量上传的CSV文件第一行应为标题行
4. **浏览器兼容**：推荐使用现代浏览器（Chrome、Firefox、Safari、Edge）
5. **网络连接**：需要互联网连接以加载CDN资源（Bootstrap、Chart.js等）

## 样例数据

系统提供了样例CSV文件 `static/sample_data.csv`，可用于测试批量上传功能。

## 问题排查

1. **页面无法访问**：检查Django服务是否正常运行，URL配置是否正确
2. **数据加载失败**：检查API接口是否正常，数据库连接是否正常
3. **图表不显示**：检查网络连接，确保Chart.js库正常加载
4. **CSV上传失败**：检查文件格式，确保CSV文件编码为UTF-8

## 开发环境启动

```bash
# 进入项目目录
cd f:\jdango_pro\bz_edu_project

# 激活虚拟环境（如果使用）
# Windows:
venv\Scripts\activate
# macOS/Linux:
# source venv/bin/activate

# 安装依赖
pip install django djangorestframework

# 运行数据库迁移
python manage.py migrate

# 启动开发服务器
python manage.py runserver

# 访问页面
# 数据可视化：http://127.0.0.1:8000/visualization/
# 数据上传：http://127.0.0.1:8000/upload/
```
